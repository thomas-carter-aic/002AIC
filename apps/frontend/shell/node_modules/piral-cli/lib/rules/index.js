"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.addPiralRule = addPiralRule;
exports.getPiralRules = getPiralRules;
exports.addPiletRule = addPiletRule;
exports.getPiletRules = getPiletRules;
const fs_1 = require("fs");
const common_1 = require("../common");
const piralRules = [];
const piletRules = [];
function getRules(target) {
    const prefix = `${target}-`;
    return new Promise((resolve, reject) => {
        (0, fs_1.readdir)(__dirname, (err, files) => {
            if (err) {
                reject(err);
            }
            else {
                resolve(files
                    .filter((name) => name.startsWith(prefix) && name.endsWith('.js'))
                    .map((fileName) => {
                    (0, common_1.log)('generalDebug_0003', `Including module "${fileName}" ...`);
                    const run = require(`./${fileName}`).default;
                    const name = fileName.substring(prefix.length).replace(/\.js$/, '');
                    (0, common_1.log)('generalDebug_0003', `Included rule with name: "${name}".`);
                    return {
                        run,
                        name,
                    };
                }));
            }
        });
    });
}
function addPiralRule(rule) {
    piralRules.push(rule);
}
async function getPiralRules() {
    (0, common_1.log)('generalDebug_0003', 'Getting Piral validation rules ...');
    const rules = await getRules('piral');
    (0, common_1.log)('generalDebug_0003', `Found ${rules.length} rules.`);
    return [...rules, ...piralRules];
}
function addPiletRule(rule) {
    piletRules.push(rule);
}
async function getPiletRules() {
    (0, common_1.log)('generalDebug_0003', 'Getting pilet validation rules ...');
    const rules = await getRules('pilet');
    (0, common_1.log)('generalDebug_0003', `Found ${rules.length} rules.`);
    return [...rules, ...piletRules];
}
//# sourceMappingURL=index.js.map