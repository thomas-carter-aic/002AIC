"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.getAvailablePort = getAvailablePort;
exports.getFreePort = getFreePort;
const log_1 = require("./log");
const external_1 = require("../external");
async function getAvailablePort(defaultPort, strict) {
    const selectedPort = await getFreePort(defaultPort);
    if (selectedPort !== defaultPort) {
        if (strict) {
            // exit
            (0, log_1.fail)('portNotFree_0048', defaultPort);
        }
        else {
            // just print warning
            (0, log_1.log)('portChanged_0047', selectedPort, defaultPort);
        }
    }
    return selectedPort;
}
async function getFreePort(preferred) {
    (0, log_1.log)('generalDebug_0003', `Looking for a free port. Preferred port: ${preferred}`);
    const port = await (0, external_1.getPort)(preferred && { port: preferred });
    (0, log_1.log)('generalDebug_0003', `Found port ${port} free for usage.`);
    return port;
}
//# sourceMappingURL=port.js.map