export function integrateXfwd(headers, protocol, req) {
    const values = {
        for: req.remoteAddress,
        port: req.port,
        proto: req.encrypted ? `${protocol}s` : protocol,
    };
    Object.keys(values).forEach((key) => {
        const forwardKey = `x-forwarded-${key}`;
        const forward = headers[forwardKey] || '';
        const sep = forward ? ',' : '';
        headers[forwardKey] = forward + sep + values[key];
    });
}
